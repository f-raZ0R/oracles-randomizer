# some text is set after being loaded; see romdata/text.yaml.

text:
  smallKeyText: |
      You got a\x01
      small key for\x01
      \x0f\xff!\x00
  bossKeyText: |
      You got the\x01
      boss key of\x01
      \x0f\xff!\x00
  compassText: |
      You got the\x01
      compass of\x01
      \x0f\xff!\x00
  mapText: |
      You got the\x01
      dungeon map of\x01
      \x0f\xff!\x00

seasonstext:
  d0Text: |
      Hero's Cave\x00
  d1Text: |
      Gnarled Root\x01
      Dungeon\x00
  d2Text: |
      Snake's Remains\x00
  d3Text: |
      Poison Moth's\x01
      Lair\x00
  d4Text: |
      Dancing Dragon\x01
      Dungeon\x00
  d5Text: |
      Unicorn's Cave\x00
  d6Text: |
      Ancient Ruins\x00
  d7Text: |
      Explorer's\x01
      Crypt\x00
  d8Text: |
      Sword & Shield\x01
      Maze\x00
  d12Text: |
      \x00

agestext:
  d0Text: |
      Maku Path\x00
  d1Text: |
      Spirit's Grave\x00
  d2Text: |
      Wing Dungeon\x00
  d3Text: |
      Moonlit Grotto\x00
  d4Text: |
      Skull Dungeon\x00
  d5Text: |
      Crown Dungeon\x00
  d6Text: |
      Mermaid's Cave\x01
      Present\x00
  d7Text: |
      Jabu Jabu's\x01
      Belly\x00
  d8Text: |
      Ancient Tomb\x00
  d12Text: |
      Mermaid's Cave\x01
      Past\x00

common:
  # override addresses for owl statue text.
  # (Note: needs to be updated to work with "useCustomText" below.)
  3f/useOwlText: |
      ld (w7ActiveBank),a
      ld a,(wTextIndexH)
      cp a,3d
      ret nz
      ld hl,owlTextOffsets
      ld a,(wTextIndexL)
      rst 18
      ldi a,(hl)
      ld h,(hl)
      ld l,a
      ld a,BANK_OWL_TEXT
      ld (w7ActiveBank),a
      ret

  # Checks for custom text (currently just for keysanity).
  3f/useCustomText: |
      ld (w7ActiveBank),a
      ld a,(wTextIndexH)
      cp a,04
      ret nz
      ld a,(wTextIndexL)
      sub a,90
      ret c
      ld hl,customTextOffsets
      rst 18
      ldi a,(hl)
      ld h,(hl)
      ld l,a
      ld a,3f
      ld (w7ActiveBank),a
      ret

  3f/customTextOffsets: |
      dw smallKeyText # 90
      dw bossKeyText  # 91
      dw compassText  # 92
      dw mapText      # 93
      dw 0
      dw 0
      dw 0
      dw 0
      dw d0Text # 98
      dw d1Text # 99
      dw d2Text # 9a
      dw d3Text
      dw d4Text
      dw d5Text
      dw d6Text
      dw d7Text
      dw d8Text
      dw 0
      dw 0
      dw 0
      dw d12Text
      dw d0Text # Ages "maku road" is actually dungeon index 0d (13)

  3f/smallKeyText: /include smallKeyText
  3f/bossKeyText: /include bossKeyText
  3f/compassText: /include compassText
  3f/mapText: /include mapText
  3f/d0Text: /include d0Text
  3f/d1Text: /include d1Text
  3f/d2Text: /include d2Text
  3f/d3Text: /include d3Text
  3f/d4Text: /include d4Text
  3f/d5Text: /include d5Text
  3f/d6Text: /include d6Text
  3f/d7Text: /include d7Text
  3f/d8Text: /include d8Text
  3f/d12Text: /include d12Text

floating:
  # replace text in script command 9a (showtextnonexitable) using
  # scriptTextReplacements: four-byte entries, first two bytes are old text
  # index, second two bytes are new text index.
  scriptShowTextNonExitableCustom: |
      push de
      ld e,2
      ld hl,scriptTextReplacements
      call searchDoubleKey
      pop de
      jr nc,.done
      ldi a,(hl)
      ld b,a
      ld c,(hl)
      .done
      jp showTextNonExitable

seasons:
  3f/owlText: ''

  # remove generic text from shops so that replacement text can be displayed.
  08/4d46/: db 00,4c,00,1f,4d,00,4b,6d,4b,6d,4b,32,00,00,4b,00,00

  0a/7b9e/: ret; nop; nop # ??

  # overwritten in-place
  1e/5375/membersShopSatchelText: ''
  1e/53a0/membersShopMapText: ''

  # overwrites maku tree text
  1e/6265/emberSeedText: '' # 1704, cutscene after d1
  10/useEmberSeedText: |
      cp a,e5
      jr nz,.done
      ld bc,1704
      .done
      jp showText
  10/4ade/: call useEmberSeedText
  1e/6361/shopFluteText: '' # 1707, cutscene after d2
  1e/63e0/membersShopGashaText: '' # 1709, cutscene after d3
  1e/6699/marketRibbonText: '' # 1726, cutscene after d4 if d4 < d5
  1e/66f6/marketPeachStoneText: '' # 1728, cutscene after d5 if d5 < d4
  1e/6777/marketCardText: '' # 172a, cutscene after d5 if d4 < d5
  1e/67ba/marketEndText: '' # 172b, cutscene after d4 is d5 < d4
  0b/scriptShowTextNonExitableCustom: /include scriptShowTextNonExitableCustom
  0b/scriptTextReplacements: |
      db 0e,1b,17,07
      db 0e,1d,17,09
      db 2b,00,17,26
      db 2b,01,17,28
      db 2b,10,17,2a
      db ff
  0b/42e8/: call scriptShowTextNonExitableCustom

  # overwrites rosa hide and seek preamble
  1f/4533/cliffWarningText: ''
  1f/4584/hssSkipWarningText: ''
  1c/6b52/: dw 9202 # pointer to above
  1f/459f/warningEndText: ''
  1c/6b54/: dw 921d # pointer to above

  # 3f/4fd9/: call useOwlText
  3f/4fd9/: call useCustomText

ages:
  # set text index for portal sign on crescent island.
  06/setSignTextIndex: |
      ld bc,a300 # Present Octo Fairy Island
      call compareRoom
      jr z,.endComparison
      ld bc,a900 # Present Cresent Island NW
      call compareRoom
      jr z,.endComparison
      ld bc,d000 # Present Zora Village SW
      call compareRoom
      jr z,.endComparison
      ld bc,da00 # Present Crescent Island SW
      call compareRoom
      .endComparison
      ld bc,0901
      ret nz
      ld bc,5601
      ret
  06/40e7/: call setSignTextIndex

  38/owlText: ''

  # overwritten in-place
  1e/4c3e/tuneOfEchoesText: ''
  1d/7e48/tuneOfCurrentsText: ''
  1d/7e8e/tuneOfAgesText: ''
  23/583f/portalSignText: ''

  # overwrites maku tree text
  1e/683f/emberSeedText: '' # 05b0, cutscene after d1
  11/useEmberSeedText: |
      cp a,85
      jr nz,.done
      ld bc,05b0
      .done
      jp showText
  11/4a7e/: call useEmberSeedText
  1e/6871/shopFluteText: '' # 05b1, cutscene when breaking d2?
  0c/scriptShowTextNonExitableCustom: /include scriptShowTextNonExitableCustom
  0c/scriptTextReplacements: |
      db 0e,1b,05,b1
      db ff
  0c/4300/: call scriptShowTextNonExitableCustom

  # 3f/4faa/: call useOwlText
  3f/4faa/: call useCustomText
